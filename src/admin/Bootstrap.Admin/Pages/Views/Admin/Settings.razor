@inherits SettingsBase

<ConditionComponent AuthKey="saveTitle">
    <div class="card">
        <div class="card-header">系统名称设置</div>
        <div class="card-body">
            <ConditionComponent>
                <div class="alert alert-danger" role="alert">
                    <span>演示系统禁止更改系统名称</span>
                </div>
            </ConditionComponent>
            <div class="form-group">
                <div class="input-group">
                    <input type="text" class="form-control" id="sysName" placeholder="请输入网站标题，50字以内" value="@Model.Title" />
                    <ConditionComponent Inverse="true">
                        <div class="input-group-append">
                            <button class="btn btn-secondary" type="button">保存</button>
                        </div>
                    </ConditionComponent>
                </div>
            </div>
        </div>
    </div>
</ConditionComponent>
<ConditionComponent AuthKey="saveFooter">
    <div class="card">
        <div class="card-header">页脚设置</div>
        <div class="card-body">
            <ConditionComponent>
                <div class="alert alert-danger" role="alert">
                    <span>演示系统禁止更改页脚</span>
                </div>
            </ConditionComponent>
            <div class="form-group">
                <div class="input-group">
                    <input type="text" class="form-control" id="sysFoot" placeholder="请输入网站页脚，50字以内" value="@Model.Footer" />
                    <ConditionComponent Inverse="true">
                        <div class="input-group-append">
                            <button class="btn btn-secondary" type="button">保存</button>
                        </div>
                    </ConditionComponent>
                </div>
            </div>
        </div>
    </div>
</ConditionComponent>
<ConditionComponent AuthKey="saveTheme">
    <div class="card">
        <div class="card-header">网站样式</div>
        <div class="card-body">
            <div class="alert alert-info" role="alert">
                <span>注意：<b><a class="badge-pill" href="./Profiles">个人中心</a></b>中设置的网站样式覆盖本设置</span>
            </div>
            <div class="form-group text-right">
                <div class="btn-group" role="group">
                    <div class="btn-group" role="group">
                        <button id="dictCssDefine" class="btn btn-success dropdown-select dropdown-toggle" data-toggle="dropdown" data-default-val="" value="@Model.Theme">默认样式</button>
                        <div class="dropdown-menu">
                            <a href="#" data-val="">默认样式</a>
                            @foreach (var css in Model.Themes)
                            {
                                <a href="#" data-val="@css.Code">@css.Name</a>
                            }
                        </div>
                    </div>
                    <button class="btn btn-secondary" type="button" data-method="css">保存</button>
                </div>
            </div>
        </div>
    </div>
</ConditionComponent>
<ConditionComponent AuthKey="saveUISettings">
    <div class="card">
        <div class="card-header">网站调整</div>
        <div class="card-body">
            <div class="form-inline">
                <div class="row">
                    <div class="form-group col-6">
                        <label class="control-label" for="sider">侧边栏设置</label>
                        <Toggle @bind-Value="@Model.ShowSideBar"></Toggle>
                    </div>
                    <div class="form-group col-6">
                        <label class="control-label" for="cardTitle">标题设置</label>
                        <Toggle @bind-Value="@Model.ShowCardTitle" OnText="显示" OffText="关闭"></Toggle>
                    </div>
                    <div class="form-group col-6">
                        <label class="control-label" for="cardTitle">固定表头</label>
                        <Toggle @bind-Value="@Model.FixedTableHeader" OnText="固定" OffText="跟随"></Toggle>
                    </div>
                </div>
            </div>
            <div class="modal-footer text-right">
                <button class="btn btn-secondary" type="button" @onclick="SaveWebSettings"><i class="fa fa-save"></i><span>保存</span></button>
            </div>
        </div>
    </div>
</ConditionComponent>
<ConditionComponent AuthKey="loginSettings">
    <div class="card" asp-auth="loginSettings">
        <div class="card-header">登录设置</div>
        <div class="card-body">
            <ConditionComponent>
                <div class="alert alert-danger" role="alert">
                    <span>演示系统禁止更改登录设置</span>
                </div>
            </ConditionComponent>
            <div class="form-inline">
                <div class="row">
                    <div class="form-group col-6">
                        <label class="control-label" for="mobile">手机登录</label>
                        <Toggle @bind-Value="@Model.ShowMobile" OnText="允许" OffText="关闭"></Toggle>
                    </div>
                    <div class="form-group col-6">
                        <label class="control-label" for="cardTitle">OAuth 认证</label>
                        <Toggle @bind-Value="@Model.ShowOAuth" OnText="允许" OffText="关闭"></Toggle>
                    </div>
                </div>
            </div>
            <ConditionComponent Inverse="true">
                <div class="modal-footer text-right">
                    <button class="btn btn-secondary" type="button" @onclick="SaveLogin"><i class="fa fa-save"></i><span>保存</span></button>
                </div>
            </ConditionComponent>
        </div>
    </div>
</ConditionComponent>
<ConditionComponent AuthKey="lockScreen">
    <div class="card">
        <div class="card-header">自动锁屏设置</div>
        <div class="card-body">
            <div class="form-inline">
                <div class="row">
                    <div class="form-group col-6">
                        <label class="control-label" for="lockScreen">自动锁屏</label>
                        <Toggle @bind-Value="@Model.AutoLockScreen" OnText="开启" OffText="关闭"></Toggle>
                    </div>
                    <div class="form-group col-6">
                        <label class="control-label" for="lockPeriod">时长间隔(秒)</label>
                        <input id="lockPeriod" type="number" class="form-control" value="@Model.LockScreenPeriod" />
                    </div>
                </div>
            </div>
            <div class="modal-footer text-right">
                <button class="btn btn-secondary" type="button"><i class="fa fa-save"></i><span>保存</span></button>
            </div>
        </div>
    </div>
</ConditionComponent>
<ConditionComponent AuthKey="lockScreen">
    <div class="card" asp-auth="defaultApp">
        <div class="card-header">默认应用设置</div>
        <div class="card-body">
            <div class="alert alert-info" role="alert">
                <span>开启此功能后用户登录时默认导航到第一个已授权的前台应用</span>
            </div>
            <div class="form-inline">
                <div class="row">
                    <div class="form-group col-6">
                        <label class="control-label" for="defaultApp">默认应用</label>
                        <Toggle @bind-Value="@Model.DefaultApp" OnText="开启" OffText="关闭"></Toggle>
                    </div>
                </div>
            </div>
            <div class="modal-footer text-right">
                <button class="btn btn-secondary" type="button"><i class="fa fa-save"></i><span>保存</span></button>
            </div>
        </div>
    </div>
</ConditionComponent>
<ConditionComponent AuthKey="blazor">
    <div class="card">
        <div class="card-header">网站设置</div>
        <div class="card-body">
            <div class="alert alert-info" role="alert">
                <span>开启此功能网站增加 Blazor 与 MVC 切换挂件</span>
            </div>
            <div class="form-inline">
                <div class="row">
                    <div class="form-group col-6">
                        <label class="control-label" for="blazor">MVC 切换</label>
                        <Toggle @bind-Value="@Model.EnableBlazor" OnText="开启" OffText="关闭"></Toggle>
                    </div>
                </div>
            </div>
            <div class="modal-footer text-right">
                <button class="btn btn-secondary" type="button" @onclick="SaveBlazor"><i class="fa fa-save"></i><span>保存</span></button>
            </div>
        </div>
    </div>
</ConditionComponent>
<div class="card">
    <div class="card-header">
        <span>网站缓存</span>
    </div>
    <div class="card-body">
        <Table Id="settings-cache" TItem="Longbow.Cache.ICacheItem" EditModel="ConsoleCaCheModel" OnDataSourceQuery="QueryData">
            <TableHeader>
                <LgbTableHeader TItem="string" @bind-Value="@context.Desc"></LgbTableHeader>
                <LgbTableHeader TItem="int" @bind-Value="@context.Interval"></LgbTableHeader>
                <LgbTableHeader TItem="string" @bind-Value="@context.Key"></LgbTableHeader>
                <LgbTableHeader TItem="string" @bind-Value="@context.Value"></LgbTableHeader>
                <LgbTableHeader TItem="int" @bind-Value="@context.ElapsedSeconds"></LgbTableHeader>
            </TableHeader>
            <RowTemplate>
                <td>@context.Desc</td>
                <td>@(context.Interval / 1000)</td>
                <td>@context.Key</td>
                <td>@context.Value</td>
                <td>@context.ElapsedSeconds</td>
            </RowTemplate>
            <TableToolbarTemplate>
                <TableToolbarButton class="btn btn-danger" Icon="fa fa-trash-o" Title="一键清除" OnClick="ClearCache" />
            </TableToolbarTemplate>
            <ButtonTemplate>
                <button class='btn btn-sm btn-danger' asp-auth="del" @onclick="e => DeleteCache(context.Key)"><i class='fa fa-remove'></i><span>删除</span></button>
            </ButtonTemplate>
        </Table>
    </div>
</div>
<Toast @ref="Toast" Id="toast_settings"></Toast>
