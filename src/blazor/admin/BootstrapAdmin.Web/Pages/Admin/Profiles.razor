@page "/Admin/Profiles"

<div class="tab-scroll-body">
    <AdminCard HeaderText="基本资料" AuthorizeKey="SaveDisplayName">
        <AdminAlert Text="演示系统禁止更改管理员显示名称" />
        <ValidateForm OnValidSubmit="OnSaveDisplayName" Model="CurrentUser">
            <EditorForm AutoGenerateAllItem="false" TModel="User" RowType="RowType.Inline" ItemsPerRow="2">
                <FieldItems>
                    <EditorItem @bind-Field="context.UserName" Readonly="true" />
                    <EditorItem @bind-Field="context.DisplayName" />
                </FieldItems>
                <Buttons>
                    <SubmitButton />
                </Buttons>
            </EditorForm>
        </ValidateForm>
    </AdminCard>

    <AdminCard HeaderText="修改密码" AuthorizeKey="SavePassword">
        <AdminAlert Text="演示系统禁止更改管理员密码" />
        <ValidateForm OnValidSubmit="OnSavePassword" Model="CurrentUser">
            <div class="row g-3 form-inline">
                <div class="col-12 col-sm-6">
                    <BootstrapInput @bind-Value="@CurrentUser.Password" DisplayText="原密码" />
                </div>
                <div class="col-12 col-sm-6 d-none d-sm-block">
                </div>
                <div class="col-12 col-sm-6">
                    <BootstrapInput @bind-Value="@CurrentUser.NewPassword" />
                </div>
                <div class="col-12 col-sm-6">
                    <BootstrapInput @bind-Value="@CurrentUser.ConfirmPassword" />
                </div>
                <div class="col-12 text-end">
                    <SubmitButton />
                </div>
            </div>
        </ValidateForm>
    </AdminCard>

    <AdminCard HeaderText="默认应用" AuthorizeKey="SaveApp">
        <AdminAlert Text="演示系统禁止更改默认应用" />
        <div class="row g-3 form-inline">
            <div class="col-12 col-sm-6">
                <Dropdown Items="Apps" @bind-Value="CurrentUser.App" />
            </div>
            <div class="col-12 col-sm-6 text-end">
                <Button Icon="fa fa-save" Text="保存" OnClickWithoutRender="OnSaveApp" />
            </div>
        </div>
    </AdminCard>
</div>

@*
    <div class="card" asp-auth="saveApp">
    <div class="card-header">默认应用</div>
    <div class="card-body">
    <div class="form-group">
    <div class="btn-group" role="group">
    <button id="app" class="btn btn-success dropdown-select dropdown-toggle" data-toggle="dropdown" value="@Model.AppId">@Model.AppName</button>
    <div class="dropdown-menu">
    @foreach (var app in Model.Applications)
    {
    <a href="#" data-val="@app.Key">@app.Value</a>
    }
    </div>
    </div>
    </div>
    <div class="modal-footer">
    <button id="btnSaveApp" data-method="app" class="btn btn-secondary" type="button"><i class="fa fa-save"></i><span>保存</span></button>
    </div>
    </div>
    </div>
    <div class="card" asp-auth="saveTheme">
    <div class="card-header">网站样式</div>
    <div class="card-body">
    <div class="alert alert-info" role="alert">
    <span>注意：本设置将覆盖<b><a class="badge-pill" href="./Settings">网站设置</a></b>中设置的网站样式</span>
    </div>
    <div class="form-group">
    <div class="btn-group" role="group">
    <button id="css" class="btn btn-success dropdown-select dropdown-toggle" data-toggle="dropdown" data-default-val="" value="@Model.Css">默认样式</button>
    <div class="dropdown-menu">
    <a href="#" data-val="">默认样式</a>
    @foreach (var css in Model.Themes)
    {
    <a href="#" data-val="@css.Code">@css.Name</a>
    }
    </div>
    </div>
    </div>
    <div class="modal-footer">
    <button id="btnSaveCss" data-method="profileCss" class="btn btn-secondary" type="button"><i class="fa fa-save"></i><span>保存</span></button>
    </div>
    </div>
    </div>
    <div class="card" asp-auth="saveIcon">
    <div class="card-header">修改头像</div>
    <div class="card-body">
    <form enctype="multipart/form-data">
    <div class="form-group">
    <input id="fileIcon" type="file" data-init="@Model.Size" data-file="@Model.FileName">
    </div>
    </form>
    <img class="card-img d-none" src="@Url.Content(Model.Icon)" />
    </div>
    </div>*@